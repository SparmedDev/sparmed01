{% extends 'base.html' %}

{% load static from staticfiles %}
{% load bootstrap3 %}
{% load compress %}

{% block pagedescription %}Browse the finest quality IVF Laboratory equipment{% endblock %}
{% block title %}Products{% endblock %}


{% block body %}

{% if categories %}
<nav id="products-nav" role="navigation">
  <ul class="nav nav-tabs" role="tablist">
    {% for cat in categories reversed %}
    <li><a href="{{ cat.get_absolute_url }}">{{ cat.name }}</a></li>
    {% endfor %}
  </ul>
</nav>
{% endif %}

<article class="category-article">
  <h1>{{ category.name }}</h1>
  {% if category.description %}<p class="text-center"><em>{{ category.description }}</em></p>{% endif %}

  <hr>

  {% with category.subcategories.all as subcats %}
  {% for subcat in subcats %}
  <h2 class="text-center">{{ subcat.name }}</h2>
  {% if subcat.description %}<p class="text-center"><em>{{ subcat.description }}</em></p>{% endif %}

  {% for product in subcat.products.all reversed %}
  {% if forloop.counter0|divisibleby:"4" or forloop.first %}
  <div class="row">
    {% endif %}
    <div class="col-sm-3">
      <div class="product-item">
        <a title="{{ product.name }}" href="{{ product.get_absolute_url }}">
          <h3>{{ product.name }}</h3>
          <p>Product ID: {{ product.product_id }}</p>
          {% if product.description %}<p class="text-center"><em>{{ product.description }}</em></p>{% endif %}

          {% with product.images.all|first as image %}
          {% if image %}
          <p><img class="img-responsive img-rounded product-image" alt="{{ image.image_title }}" src="{{ image.get_absolute_url }}"></p>
          {% endif %}
          {% endwith %}
        </a>
      </div>
    </div>
    {% if not forloop.first or forloop.last %}{% if forloop.counter|divisibleby:"4" or forloop.last %}</div>{% endif %}{% endif %}
  {% endfor %}

  {% if not forloop.last %}<hr>{% endif %}

  {% endfor %}
  {% endwith %}
  
</article>
{% endblock %}

{% block endbody %}

{% compress js inline %}
<script type="text/javascript">
    //$('#products-nav li').click(function(e) {
  $('#products-nav > .nav-tabs').on('click', 'li', function () {
        $('#products-nav li').removeClass('active');
        $(this).addClass('active');
        console.log("clicked");
    });
  
    /*$(document).ready(function() {
        $('#products-nav li:first').addClass('active');
    });*/
</script>
{% endcompress %}

{% endblock %}