{% extends 'base.html' %}

{% load static from staticfiles %}
{% load bootstrap3 %}
{% load compress %}
{% load base_extras %}

{% block pagedescription %}Browse the finest quality IVF Laboratory equipment{% endblock %}
{% block title %}Products{% endblock %}


{% block body %}

{% if categories %}
<nav id="products-nav" role="navigation">
  <ul class="nav nav-tabs" role="tablist">
    {% for cat in categories reversed %}
    {% with catslug=cat.slug %}
    <li class="{% productnavactive request catslug %}"><a href="{{ cat.get_absolute_url }}">{{ cat.name }}</a></li>
    {% endwith %}
    {% endfor %}
  </ul>
</nav>
{% endif %}

<article class="category-article">
  <h1 class="text-center">{{ category.name }}</h1>
  {% if category.description %}<p class="text-center"><em>{{ category.description }}</em></p>{% endif %}

  <hr>

  {% with subcats=category.subcategories.all %}
  {% for subcat in subcats %}
  <h2 class="text-center">{{ subcat.name }}</h2>
  {% if subcat.description %}<p class="text-center"><em>{{ subcat.description }}</em></p>{% endif %}

  {% for product in subcat.products.all reversed %}
  {% if forloop.counter0|divisibleby:"4" or forloop.first %}
  <div class="row">
    {% endif %}
    <div class="col-sm-3">
      <article class="product-item">
        <h4><a title="{{ product.name }}" href="{{ product.get_absolute_url }}">{{ product.name }}</a></h4>

        <p>Product ID: {{ product.product_id }}</p>

        {% with image=product.images.all|first %}
        {% if image %}
        <p><img class="img-responsive img-rounded product-image" alt="{{ image.image_title }}" src="{{ image.get_absolute_url }}"></p>
        {% endif %}
        {% endwith %}
      </article>
    </div>
    {% if not forloop.first or forloop.last %}{% if forloop.counter|divisibleby:"4" or forloop.last %}</div>{% endif %}{% endif %}
  {% endfor %}

  {% if not forloop.last %}<hr>{% endif %}

  {% endfor %}
  {% endwith %}
  
</article>
{% endblock %}